<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>            WriteUp HTB - Máquina Keeper - RuyzTzt7      Ciberseguridad y Hacking Ético      </title>
<meta name="description" content="En este artículo, resolveremos la máquina Keeper de la plataforma HTB.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="RuyzTzt7 | Ciberseguridad y Hacking Ético">
<meta property="og:title" content="WriteUp HTB - Máquina Keeper">
<meta property="og:url" content="http://localhost:4000/writeup-keeper/">


  <meta property="og:description" content="En este artículo, resolveremos la máquina Keeper de la plataforma HTB.">



  <meta property="og:image" content="http://localhost:4000/assets/images/htb/keeper/logo.png">





  <meta property="article:published_time" content="2025-04-07T00:00:00+02:00">





  

  


<link rel="canonical" href="http://localhost:4000/writeup-keeper/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Álvaro",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="RuyzTzt7 | Ciberseguridad y Hacking Ético Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
                
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/" >Artículos</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categorías</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Etiquetas</a>
            </li><li class="masthead__menu-item">
              <a href="/buscador/" >Buscador</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >Contacto</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">WriteUp HTB - Máquina Keeper</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="Álvaro Ruiz Gutiérrez" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Álvaro Ruiz Gutiérrez</h3>
    
    
      <p class="author__bio" itemprop="description">
        Estudiante de Ingeniería Informática del Software de la Universidad de Sevilla y Futuro Analista de CiberSeguridad
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://www.linkedin.com/in/alvaro-ruiz-guti%C3%A9rrez-515684314/" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn
          </a>
        </li>
      

      

      
        <li>
          <a href="https://instagram.com/alvarorugu7" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram
          </a>
        </li>
      

      

      

      
        <li>
          <a href="https://github.com/alvruigut" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="WriteUp HTB - Máquina Keeper">
    <meta itemprop="description" content="En este artículo, resolveremos la máquina Keeper de la plataforma HTB.">
    <meta itemprop="datePublished" content="April 07, 2025">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">WriteUp HTB - Máquina Keeper
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2025-04-07T00:00:00+02:00">April 07, 2025 </time>&emsp;
          
          
        </p>
        <p align="center">
  <img src="/assets/images/htb/keeper/logo2.png" alt="Beep" width="2200" />
</p>

<blockquote>
  <h1 id="ip-keeper-1012922941">IP Keeper: 10.129.229.41</h1>
  <h1 id="ip-local-10101610">IP Local: 10.10.16.10</h1>
</blockquote>

<h2 id="1-enumeración-de-puertos-de-la-máquina">1. Enumeración de Puertos de la Máquina</h2>

<p>Primeramente comprobamos que tenemos acceso a la máquina Keeper con una traza ICMP de un paquete. 
Además la conexión, nos permite identificar por el valor TTL (Time to alive), 
si nos enfrentamos a una máquina Linux(TTL -&gt; 64) o Windows( -&gt; 128)</p>

<ul>
  <li><strong>Comando:</strong>
    <div style="background-color: rgba(156, 28, 66, 0.49); color: #fff; padding: 6px 10px; border-radius: 5px; font-family: 'Fira Code', 'Courier New', monospace; font-size: 14px;">
  <pre style="margin: 0;"><code>ping -c 1 10.129.229.41</code></pre>
</div>
  </li>
</ul>

<p>En HTB, se aprecia que el TTL es una unidad menor. Para visualizar la ruta completa de la conexión y comprobar que existe un nodo intermediario entre el atacante y la víctima, se utiliza la flag <strong>-R</strong>:</p>

<ul>
  <li><strong>Comando:</strong>
    <div style="background-color: rgba(156, 28, 66, 0.49); color: #fff; padding: 6px 10px; border-radius: 5px; font-family: 'Fira Code', 'Courier New', monospace; font-size: 14px;">
  <pre style="margin: 0;"><code>ping -c 1 10.129.229.41 -R</code></pre>
</div>
  </li>
</ul>

<p>A continuación, se crea un directorio de trabajo en el escritorio, nombrándolo según la máquina:</p>

<ul>
  <li><strong>Comando:</strong>
    <div style="background-color: rgba(156, 28, 66, 0.49); color: #fff; padding: 6px 10px; border-radius: 5px; font-family: 'Fira Code', 'Courier New', monospace; font-size: 14px;">
  <pre style="margin: 0;"><code>mkdir Keeper</code></pre>
</div>
  </li>
</ul>

<p>Para organizar el ataque, se utiliza una función personalizada llamada <strong>mkt</strong> (definida en el archivo .zshrc) que crea tres carpetas: <code class="language-plaintext highlighter-rouge">nmap</code>, <code class="language-plaintext highlighter-rouge">content</code> y <code class="language-plaintext highlighter-rouge">exploits</code>.</p>

<ul>
  <li><strong>Función:</strong>
    <div style="background-color: rgba(156, 28, 66, 0.49); color: #fff; padding: 6px 10px; border-radius: 5px; font-family: 'Fira Code', 'Courier New', monospace; font-size: 14px;">
  <pre style="margin: 0;"><code>mkt () {
mkdir {nmap,content,exploits}
}</code></pre>
</div>
  </li>
</ul>

<p>Dentro de la carpeta <strong>nmap</strong>, se procede a enumerar los puertos abiertos entre los 65,535 disponibles:</p>

<ul>
  <li><strong>Comando:</strong>
    <div style="background-color: rgba(156, 28, 66, 0.49); color: #fff; padding: 6px 10px; border-radius: 5px; font-family: 'Fira Code', 'Courier New', monospace; font-size: 14px;">
  <pre style="margin: 0;"><code>nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.129.229.41 -oG allPorts</code></pre>
</div>

    <ul>
      <li><strong>-p-:</strong> Escanea todo el rango de puertos.</li>
      <li><strong>–open:</strong> Muestra solo los puertos abiertos.</li>
      <li><strong>-sS:</strong> Realiza un TCP SYN Scan.</li>
      <li><strong>–min-rate 5000:</strong> Aumenta la velocidad del escaneo (más de 5000 paquetes por segundo).</li>
      <li><strong>-vvv:</strong> Modo triple verbose para mayor detalle.</li>
      <li><strong>-n:</strong> Omite la resolución DNS.</li>
      <li><strong>-Pn:</strong> Asume que el host está activo.</li>
      <li><strong>-oG:</strong> Exporta los resultados en formato grepeable, facilitando el filtrado posterior.</li>
    </ul>
  </li>
</ul>

<p align="center">
  <img src="/assets/images/htb/keeper/nmap1.png" alt="Nmap" width="800" />
</p>

<p>Una vez concluido el escaneo de puertos, se utiliza una herramienta personalizada llamada <strong>extractPorts</strong> (definida en el .zshrc) para copiar los puertos relevantes al portapapeles y proceder a la enumeración de servicios.</p>

<p align="center">
  <img src="/assets/images/htb/keeper/target.png" alt="ExtractPorts" width="900" />
</p>

<hr />

<h2 id="2-enumeración-de-servicios-de-los-puertos">2. Enumeración de Servicios de los Puertos</h2>

<p>Con la lista de puertos obtenida, se procede a identificar los servicios que corren en ellos. Esto permite conocer las versiones y configuraciones, facilitando la detección de posibles vulnerabilidades.</p>

<ul>
  <li><strong>Comando:</strong>
    <div style="background-color: rgba(156, 28, 66, 0.49); color: #fff; padding: 6px 10px; border-radius: 5px; font-family: 'Fira Code', 'Courier New', monospace; font-size: 14px;">
  <pre style="margin: 0;"><code>nmap -sCV -p22,80 -oN targeted</code></pre>
</div>

    <ul>
      <li><strong>-sC:</strong> Ejecuta scripts básicos de reconocimiento.</li>
      <li><strong>-sV:</strong> Detecta versiones y servicios.</li>
      <li><strong>-oN:</strong> Exporta los resultados en un formato normal.</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="3-análisis-de-servicios">3. Análisis de Servicios</h2>

<p>Durante esta etapa se observa que el puerto 80 y 22 estan expuestos. Se procede a examinar la web mediante un navegador y, utilizando la extensión <strong>Wappalyzer</strong> de Firefox, se identifican las tecnologías empleadas.</p>

<p align="center">
  <img src="/assets/images/htb/keeper/vhost.png" alt="Virtual Hosting" width="2500" />
</p>

<p>Al acceder a la web se produce un host discovery por lo que tendremos que añadir al /etc/hosts el dominio. Y vemos como al hacer ping al dominio, se nos resuelve el comando.</p>

<p align="center">
  <img src="/assets/images/htb/keeper/hosts.png" alt="Hosts" width="2500" />
</p>

<p>Finalmente, se revela un panel de login de Request Tracker:</p>

<p align="center">
  <img src="/assets/images/htb/keeper/login.png" alt="Login" width="2300" />
</p>

<hr />

<h2 id="4-identificación-de-vulnerabilidades">4. Identificación de Vulnerabilidades</h2>

<p>Se prueba inicialmente el acceso al panel utilizando las contraseñas por defecto, con éxito.</p>

<p align="center">
  <img src="/assets/images/htb/keeper/pass.png" alt="Password 1" width="2500" />
</p>

<p>Se detecta que hay un leak de información en el apartado de usuario donde vemos un usuario potencial y un comentario de cambio de contraseña con esta expuesta. Por lo que tratamos de conectarnos por ssh y entramos en la máquina víctima con el usuario encontrado.</p>

<ul>
  <li><strong>Comando:</strong>
    <div style="background-color: rgba(156, 28, 66, 0.49); color: #fff; padding: 6px 10px; border-radius: 5px; font-family: 'Fira Code', 'Courier New', monospace; font-size: 14px;">
  <pre style="margin: 0;"><code>ssh user@10.129.229.41</code></pre>
</div>
  </li>
</ul>

<p>Posteriormente, encontramos un zip que contiene un keepass y un volcado de un dumpeo de la base de datos del keepass.Por lo que para extraerlo y verlo en mi máquina, uso netcat para traerme el ficher.zip.</p>

<p align="center">
  <img src="/assets/images/htb/keeper/ziplon.png" alt="zip" width="2500" />
</p>

<p>Nota: Usando md5sum podemos spamearlo sobre el fichero que estamos extrayendo para que cuando el contenido sea estático saber que ha concluido la extracción.</p>

<p align="center">
  <img src="/assets/images/htb/keeper/md5.png" alt="md5" width="2500" />
</p>

<p>A priori, abrimos el keepas con keepassxc y vemos que nos pide la contraseña maestra. Para ello debemos de investigar sobre el dumpeo que se nos proporciona, y en ese binario con extensión .dmp existe una vulnerabilidad registrada como <strong>CVE-2023-32784</strong></p>

<p align="center">
  <img src="/assets/images/htb/keeper/keepass.png" alt="Keepass Login" width="2500" />
</p>

<hr />

<h2 id="5-explotación-de-vulnerabilidades">5. Explotación de Vulnerabilidades</h2>

<h3 id="análisis-y-explotación-de-cve-2023-32784">Análisis y Explotación de CVE-2023-32784</h3>

<p>Se identifica la vulnerabilidad, y tras horas investigando, encontré un script en python para extraer posibles contraseñas almcenadas en el binario.</p>

<p align="center">
  <img src="/assets/images/htb/keeper/exploit.png" alt="Exploit" width="2500" />
</p>

<p>Tras tener una lista de posibles contraseñas, vemos que se encuentras algunos caracteres codificados, al copiar y pegar en google vemos que son letras noruegas. Probamos dicha contraseña en el gestor de contraseñas y accedemos.</p>

<p align="center">
  <img src="/assets/images/htb/keeper/password.png" alt="Chrome Noruego" width="2500" />
</p>

<p align="center">
  <img src="/assets/images/htb/keeper/kepasword.png" alt="KeePass PAssword" width="2500" />
</p>

<p>Dentro del keepass, vemos la contraseña del usuario root, la cual no funcionaba ni el la web ni por ssh. En las notas había una clave privada pero en formato PuTTY <strong>.ppk</strong>.</p>
<p align="center">
  <img src="/assets/images/htb/keeper/putty.png" alt="Credenciales root" width="2500" />
</p>

<p>Nos copiamos el contenido en neustro equipo para trabajar sobre este.</p>
<p align="center">
  <img src="/assets/images/htb/keeper/fileppk.png" alt="File .ppk" width="2500" />
</p>

<p>Usamos la herramiento de puttygen para convertirlo a RSA <strong>.pem</strong> que estamos acostumbrado a usar.</p>

<ul>
  <li><strong>Comando:</strong>
    <div style="background-color: rgba(156, 28, 66, 0.49); color: #fff; padding: 6px 10px; border-radius: 5px; font-family: 'Fira Code', 'Courier New', monospace; font-size: 14px;">
  <pre style="margin: 0;"><code>sudo apt-get install putty-tools</code></pre>
</div>
  </li>
  <li><strong>Comando:</strong>
    <div style="background-color: rgba(156, 28, 66, 0.49); color: #fff; padding: 6px 10px; border-radius: 5px; font-family: 'Fira Code', 'Courier New', monospace; font-size: 14px;">
  <pre style="margin: 0;"><code>puttygen key.ppk -O private-openssh -o key.pem
</code></pre>
</div>
  </li>
</ul>

<p align="center">
  <img src="/assets/images/htb/keeper/id_rsa.png" alt="File .pem" width="2500" />
</p>

<p>Una vez Obtenido la clave privada, le damos el permiso 600</p>
<ul>
  <li><strong>Comando:</strong>
    <div style="background-color: rgba(156, 28, 66, 0.49); color: #fff; padding: 6px 10px; border-radius: 5px; font-family: 'Fira Code', 'Courier New', monospace; font-size: 14px;">
  <pre style="margin: 0;"><code>chmod 600 key.pem</code></pre>
</div>
  </li>
</ul>

<p>Y con el parámetro  -i nos conectamos por ssh.</p>
<ul>
  <li><strong>Comando:</strong>
    <div style="background-color: rgba(156, 28, 66, 0.49); color: #fff; padding: 6px 10px; border-radius: 5px; font-family: 'Fira Code', 'Courier New', monospace; font-size: 14px;">
  <pre style="margin: 0;"><code>ssh -i key.pem root@10.129.229.41</code></pre>
</div>
  </li>
</ul>

<p align="center">
  <img src="/assets/images/htb/keeper/pwnd.png" alt="File .pem" width="2500" />
</p>

<p>Así conseguimos ganar acceso a la máquina y directamente como el usuario root.</p>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#clave-privada" class="page__taxonomy-item" rel="tag">Clave Privada</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#cve-2023-32784" class="page__taxonomy-item" rel="tag">CVE-2023-32784</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#ejpt" class="page__taxonomy-item" rel="tag">eJPT</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#extensi%C3%B3n-ppk" class="page__taxonomy-item" rel="tag">Extensión .ppk</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#f%C3%A1cil" class="page__taxonomy-item" rel="tag">Fácil</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#information-leakage" class="page__taxonomy-item" rel="tag">Information Leakage</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#keepass-kdbx" class="page__taxonomy-item" rel="tag">KeePass .kdbx</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#linux" class="page__taxonomy-item" rel="tag">Linux</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#putty" class="page__taxonomy-item" rel="tag">Putty</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#request-tracker" class="page__taxonomy-item" rel="tag">Request Tracker</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#rsa" class="page__taxonomy-item" rel="tag">RSA</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#ejpt" class="page__taxonomy-item" rel="tag">eJPT</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#htb" class="page__taxonomy-item" rel="tag">HTB</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#writeup" class="page__taxonomy-item" rel="tag">WriteUp</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Fecha:</strong> <time datetime="2025-04-07T00:00:00+02:00">April 07, 2025</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/compartir-archivos-a-nivel-de-red/" class="pagination--pager" title="Transferencia de Archivos entre Parrot y Windows
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 Álvaro</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
